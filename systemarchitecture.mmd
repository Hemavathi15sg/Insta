graph TB
    subgraph Client["ðŸŽ¨ React Frontend (Port 3001)"]
        UI["Profile Page UI"]
        FB["FollowButton Component"]
        FL["FollowersList Modal"]
        State["React State<br/>isFollowing, loading, error"]
    end

    subgraph Server["ðŸš€ Express Backend (Port 5000)"]
        Routes["Route Handler<br/>/api/users/:id/follow"]
        Auth["JWT Auth Middleware"]
        Validation["Input Validation"]
        Service["Follow Service Logic"]
    end

    subgraph Database["ðŸ’¾ SQLite Database"]
        Users["users table<br/>id, username, email, avatar"]
        Follows["user_follows table<br/>id, follower_id, following_id,<br/>created_at, updated_at"]
        Indexes["Indexes<br/>follower_id, following_id<br/>relationship"]
    end

    UI -->|User clicks Follow| FB
    FB -->|POST /api/users/:id/follow| Routes
    Routes -->|Verify Token| Auth
    Auth -->|Token Valid| Validation
    Validation -->|Validate IDs| Service
    Service -->|Check user exists| Users
    Service -->|Prevent self-follow| Users
    Service -->|Check not following| Follows
    Service -->|INSERT follow| Follows
    Follows -->|Return new follow| Service
    Service -->|HTTP 201 + follow data| Routes
    Routes -->|Response| FB
    FB -->|Update State| State
    State -->|Re-render| UI

    UI -->|User clicks Following| FB
    FB -->|DELETE /api/users/:id/follow| Routes
    Routes -->|Verify Token| Auth
    Auth -->|Token Valid| Validation
    Validation -->|Validate IDs| Service
    Service -->|Check following| Follows
    Service -->|DELETE follow| Follows
    Follows -->|Confirm deletion| Service
    Service -->|HTTP 200| Routes
    Routes -->|Response| FB
    FB -->|Update State| State
    State -->|Re-render| UI

    UI -->|Click Followers| FL
    FL -->|GET /api/users/:id/followers?page=1&limit=20| Routes
    Routes -->|No Auth Required| Validation
    Validation -->|Validate user ID| Service
    Service -->|JOIN users + follows| Follows
    Follows -->|Get follower list| Users
    Service -->|Paginate results| Service
    Service -->|HTTP 200 + followers array| Routes
    Routes -->|Response| FL
    FL -->|Update followers state| FL
    FL -->|Render modal| UI

    FB -->|GET /api/users/:id/following-status/:targetId| Routes
    Routes -->|Verify Token| Auth
    Auth -->|Token Valid| Validation
    Validation -->|Check user match| Service
    Service -->|Query follow status| Follows
    Follows -->|Return status| Service
    Service -->|HTTP 200 + isFollowing| Routes
    Routes -->|Response| FB
    FB -->|Set initial state| State

    style Client fill:#e1f5ff
    style Server fill:#f3e5f5
    style Database fill:#e8f5e9
    style UI fill:#ffecb3
    style FB fill:#ffecb3
    style FL fill:#ffecb3
    style State fill:#ffecb3
    style Routes fill:#ce93d8
    style Auth fill:#ce93d8
    style Validation fill:#ce93d8
    style Service fill:#ce93d8
    style Users fill:#81c784
    style Follows fill:#81c784
    style Indexes fill:#81c784